<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
  .button {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 5px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 12px;
    margin: 4px 2px;
    cursor: pointer;
  }

  .round {
    border-radius: 8px;
  }

  #response {
    background-color: #ff9800;
  }
</style>
<link rel="stylesheet" href="https://waph-uc.github.io/style1.css">
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<title>WAPH-Seth Okai Student</title>
</head>
<body>
<div id="top">
  <h1>Web Application Programming and Hacking</h1>
  <h2>Front-end Web Development Lab</h2>
  <h3>Instructor: Dr. Phu Phung</h3>
</div>
<div id="menubar">
  <h3>Student: Seth Okai</h3>
  <div id="email" onclick="showhideEmail()">Show my email</div>
  <script src="email.js"></script>
  <img src="Images/headshot.jpg" alt="My Headshot" width="50">
  <div id="digital-clock"></div>
  <canvas id="analog-clock" width="150" height="150" style="background-color:#999"></canvas>
  <script src="https://waph-uc.github.io/clock.js"></script>
  <script type="text/javascript">
    var canvas = document.getElementById("analog-clock");
    var ctx = canvas.getContext("2d");
    var radius = canvas.height / 2;
    ctx.translate(radius, radius);
    radius = radius * 0.90;
    setInterval(drawClock, 1000);

    function drawClock() {
      drawFace(ctx, radius);
      drawNumbers(ctx, radius);
      drawTime(ctx, radius);
    }

    function displayTime() {
      document.getElementById('digital-clock').innerHTML = "Current time:" + new Date();
    }
    setInterval(displayTime, 500);

    function getEcho() {
      var input =  document.getElementById("dataEcho").value;
      if (input.trim() === "") { // Input validation
        alert("Input field cannot be empty");
        return;
      }
      
      input = input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, ''); // Removing script tags
      var encodedInput = encodeURIComponent(input); // Encoding input
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200){
          console.log("Received data="+xhttp.responseText);
          document.getElementById("response").innerText = "response from Server:" + xhttp.responseText;
        }
      }
      xhttp.open("GET", "echo.php?data=" + encodedInput, true);
      xhttp.send();
      document.getElementById("dataEcho").value = "";
    }

    function jQueryAjaxget() {
      var input = $("#dataGet").val();
      if (input.trim() === "") { // Input validation
        alert("Input field cannot be empty");
        return;
      }
      
      input = input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, ''); // Removing script tags
      var encodedInput = encodeURIComponent(input); // Encoding input
      $.get("echo.php?data=" + encodedInput, function (result) {
        $("#response").html("Response from server:" + result);
      });

      $("#dataGet").val("");
    }

    function jQueryAjaxpost() {
      var input = $("#dataPost").val();
      if (input.trim() === "") { // Input validation
        alert("Input field cannot be empty");
        return;
      }
      
      input = input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, ''); // Removing script tags
      var encodedInput = encodeURIComponent(input); // Encoding input
      $.post("echo.php", { data: encodedInput }, function (result) {
        $("#response").html("Response from server:" + result);
      });

      $("#dataPost").val("");
    }

    function guessAge() {
      var name = $("#name").val();
      if (name.trim() === "") { // Input validation
        alert("Name field cannot be empty");
        return;
      }

      fetch("https://api.agify.io/?name=" + encodeURIComponent(name))
        .then(response => response.json())
        .then(data => {
          $("#response").html("Hi " + name + ", your age should be " + data.age);
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }

    $.get("https://v2.jokeapi.dev/joke/Programming?type=single",
  function(result) {
    console.log("From jokeAPI:" + JSON.stringify(result));
    $("#response").html("A programming joke of the day: " + result.joke);
  }
);
  </script>
</div>
<div id="main">
  <p>A simple HTML page </p>
  Using the <a href="https://www.w3schools.com/html"> W3Schools template</a>
  <hr>
  <b>Interaction with forms</b>

  <div>
    <i>Form With an HTTP GET Request</i>
    <form onsubmit="return false;">
      Your input: <input name="data" id="dataEcho">
      <input type="button" value="Submit" onclick="getEcho()">
    </form>
  </div> 

  <div>
    <i>Form With an HTTP POST Request</i>
    <form onsubmit="return false;">
      Your input: <input name="data" id="dataPost">
      <input type="button" value="Submit" onclick="jQueryAjaxpost()">
    </form>
  </div>

  <div>
    <i>Ajax requests</i><br>
    Your input:
    <input name="data" id="dataGet" onkeypress="console.log('you have press a key')">
    <input class="button round" type="button" value="Ajax Echo" onclick="jQueryAjaxget()">
    <input class="button round" type="button" value="Guess Age" onclick="guessAge()">
    <div>Name: <input type="text" id="name"></div>
    <div id="response"></div>
  </div>
</div>
</body>
</html>
